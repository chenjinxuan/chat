# agent(网关）

## 特性

1. 采用ws，进行双栈通信。
1. 连接管理，会话建立
1. **透传**解密后的原始数据流到后端（通过gRPC streaming)。
1. **复用**多路用户连接，到一条通往chat的物理连接。
1. 不断开连接切换后端业务。
1. 唯一入口，安全隔离核心服务。

## 协议号划分

数据包会根据协议编号（0-65535) **透传** 到对应的服务， 例如(示范）:      

      1-1000: 登陆相关协议，网关协同user_center服务处理。
      3000-4000: 聊天相关逻辑
      ....

## 消息封包格式 二进制
 
        +----------------------------------------------------------------+     
       PROTO(2) | PAYLOAD()            |     
        +----------------------------------------------------------------+     

> PROTO: 协议号       采用大端序
> PAYLOAD: 消息
